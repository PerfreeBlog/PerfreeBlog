import{_ as N,f as R,h as z,g as A}from"../../index-Cbj4A6nx.js";const r=window.Vue.createElementVNode,d=window.Vue.unref,c=window.Vue.resolveComponent,t=window.Vue.createVNode,l=window.Vue.withCtx,i=window.Vue.openBlock,v=window.Vue.createBlock,m=window.Vue.createCommentVNode,V=window.Vue.createElementBlock,M=window.Vue.withModifiers,U=window.Vue.createTextVNode,q={class:"container"},F={class:"login-box"},S={class:"login-code"},T=["src"],I={key:0},j={key:1},D={class:"login-bottom-box"},G={class:"register-box"},x=window.ElementPlus.ElMessage,H=window.ElementPlus.ElMessageBox,J=window.VueRouter.useRouter,K=window.Vue.computed,_=window.Vue.ref,L={__name:"FindPasswordView",setup(O){const P=J(),y=_();let n=_(1);const o=_({account:"",newPassword:"",email:"",findPasswordCode:"",code:"",uuid:""}),b=K(()=>({userName:[{required:!0,message:"请输入昵称",trigger:"blur"},{min:2,max:20,message:"昵称必须在2-20字之间",trigger:"blur"}],account:[{required:!0,message:"请输入账户",trigger:"blur"},{min:5,max:16,message:"账户必须在5-16字之间",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:5,max:16,message:"新密码必须在5-16字之间",trigger:"blur"}],findPasswordCode:[{required:!0,trigger:"blur",message:"邮箱验证码不能为空"}],code:[{required:!0,trigger:"blur",message:"验证码不能为空"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]}));let h=_("");const s=_(!1),k=()=>{s.value=!0,y.value.validate(p=>{p?n.value===1?R(o.value).then(e=>{e.code===200?(x.success("验证码已发送,请前往邮箱查看"),o.value.code="",f(),n.value=2,s.value=!1):(x.error(e.msg),o.value.code="",s.value=!1,f())}).catch(()=>{s.value=!1}):z(o.value).then(e=>{e.code===200?(s.value=!1,H.confirm("密码重置成功,前往登录~","提示",{confirmButtonText:"确认",showCancelButton:!1,type:"success"}).then(()=>{P.replace("/login")}).catch(()=>{})):(x.error(e.msg),o.value.code="",s.value=!1,f())}).catch(()=>{s.value=!1}):s.value=!1})},f=()=>{A().then(p=>{h.value="data:image/gif;base64,"+p.data.img,o.value.uuid=p.data.uuid})};return f(),(p,e)=>{const w=c("font-awesome-icon"),g=c("el-input"),u=c("el-form-item"),C=c("el-button"),B=c("router-link"),E=c("el-form");return i(),V("div",q,[r("div",F,[t(E,{ref_key:"findPasswordRef",ref:y,model:o.value,rules:b.value,class:"login-form"},{default:l(()=>[e[6]||(e[6]=r("h3",{class:"title"},"找回密码",-1)),d(n)===1?(i(),v(u,{key:0,prop:"account"},{default:l(()=>[t(g,{modelValue:o.value.account,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.account=a),type:"text",size:"large","auto-complete":"off",placeholder:"请输入要找回密码的账户",autocomplete:"off",readonly:"",onfocus:"this.removeAttribute('readonly');"},{prefix:l(()=>[t(w,{icon:"fa-solid fa-user "})]),_:1},8,["modelValue"])]),_:1})):m("",!0),d(n)===1?(i(),v(u,{key:1,prop:"email"},{default:l(()=>[t(g,{modelValue:o.value.email,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.email=a),type:"text",size:"large","auto-complete":"off",placeholder:"请输入邮箱地址",autocomplete:"off",readonly:"",onfocus:"this.removeAttribute('readonly');"},{prefix:l(()=>[t(w,{icon:"fa-solid fa-mail-bulk"})]),_:1},8,["modelValue"])]),_:1})):m("",!0),d(n)===2?(i(),v(u,{key:2,prop:"findPasswordCode"},{default:l(()=>[t(g,{modelValue:o.value.findPasswordCode,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.findPasswordCode=a),type:"text",size:"large","auto-complete":"off",placeholder:"请输入邮箱验证码",autocomplete:"off",readonly:"",onfocus:"this.removeAttribute('readonly');"},{prefix:l(()=>[t(w,{icon:"fa-solid fa-user "})]),_:1},8,["modelValue"])]),_:1})):m("",!0),d(n)===2?(i(),v(u,{key:3,prop:"newPassword"},{default:l(()=>[t(g,{modelValue:o.value.newPassword,"onUpdate:modelValue":e[3]||(e[3]=a=>o.value.newPassword=a),type:"password",size:"large","auto-complete":"off",placeholder:"请输入新密码"},{prefix:l(()=>[t(w,{icon:"fa-solid fa-lock "})]),_:1},8,["modelValue"])]),_:1})):m("",!0),t(u,{prop:"code"},{default:l(()=>[t(g,{modelValue:o.value.code,"onUpdate:modelValue":e[4]||(e[4]=a=>o.value.code=a),"auto-complete":"off",placeholder:"请输入验证码",size:"large",style:{width:"63%"}},{prefix:l(()=>[t(w,{icon:"fa-solid fa-fax  "})]),_:1},8,["modelValue"]),r("div",S,[r("img",{src:d(h),onClick:f,class:"login-code-img",alt:""},null,8,T)])]),_:1}),t(u,{style:{width:"100%","margin-top":"20px"}},{default:l(()=>[t(C,{loading:s.value,size:"large",type:"primary",style:{width:"100%"},onClick:M(k,["prevent"])},{default:l(()=>[d(n)===1?(i(),V("span",I,"下一步")):m("",!0),d(n)===2?(i(),V("span",j,"提 交")):m("",!0)]),_:1},8,["loading"]),r("div",D,[r("div",G,[t(B,{class:"link-type",to:"/login"},{default:l(()=>e[5]||(e[5]=[U("返回登录")])),_:1})])])]),_:1})]),_:1},8,["model","rules"])]),e[7]||(e[7]=r("div",{class:"login-footer"},[r("span",null,"Copyright © 2018-2024 All Rights Reserved. ")],-1))])}}},W=N(L,[["__scopeId","data-v-2197939f"]]);export{W as default};
