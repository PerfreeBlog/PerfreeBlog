import{_ as Z,r as h,k as ee,a as c,b as S,d as w,e as t,w as n,u as l,j as u,F as te,l as le,C as ae,f as p,D as A,G as ne,H as oe,h as C,I as F,J as N,K as $,t as ie,L as se,M as re,N as ce,O as de,n as ue,m as f,P as v,q as pe,s as me,v as _e,E as fe,y as ge,Q as he,x as ve,B as we}from"./index-DAZg6KgI.js";import{E as ye,a as be,v as ke}from"./el-table-column-DZMpWYo5.js";import{E as Ce}from"./el-pagination-x5Aplci8.js";import{p as xe,h as Te}from"./perfree-h22k_lv_.js";import{E as Ve}from"./el-image-viewer-C5NkBqy_.js";import{E as Ee,a as Be}from"./el-col-Y4mM9eD_.js";import"./el-tree-B7tPDMN7.js";import{E as Ie}from"./el-tree-select-QFC_ITVM.js";import{g as Ue}from"./tag-BQCuFRh1.js";import"./el-dialog-Cx6vfFNe.js";/* empty css                *//* empty css                                                                            */import{b as ze,c as Se,d as Ae,e as Fe,f as Ne}from"./article-DLLIOUN2.js";import{c as $e}from"./category-BFkxnEz5.js";import{E as y}from"./index-DNxUcOTo.js";const De={class:"page"},Pe={class:"search-box"},Le={class:"right-tool"},Me={class:"table-box"},Re={__name:"ArticleView",setup(je){const i=h({pageNo:1,pageSize:20,total:0,title:"",type:"article",status:null,categoryId:null,tagId:null}),x=h();let T=h([]),b=h(!1);const D=ee({children:"children",label:"name",value:"id"});let V=h([]),E=h([]);function m(){b.value=!0,ze(i.value).then(a=>{T.value=a.data.list,i.value.total=a.data.total,b.value=!1})}function P(){$e({}).then(a=>{V.value=Te(a.data,"id","pid","children",-1)})}function L(){Ue().then(a=>{E.value=a.data})}function M(){i.value={title:"",type:"article",status:null,categoryId:null,tagId:null},x.value.resetFields()}function R(){ue("","/admin/article/create","")}function Oe(a){}function j(a){y.confirm("确定要删除文章["+a.title+"]吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{Se(a.id).then(o=>{o.code===200&&o.data?(f.success("删除成功"),m()):f.error(o.msg)})}).catch(()=>{})}function O(a){let o=a.isComment===0?"允许评论":"不允许评论";y({title:"提示",message:v("p",null,[`确定要修改文章[${a.title}]为`,v("font",{style:"color: var(--el-color-warning)"},o),"吗?"]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let g={id:a.id,isComment:a.isComment===0?1:0};Fe(g).then(r=>{r.code===200?(m(),f.success("修改成功")):f.error("修改失败")})}).catch(()=>{})}function q(a){let o=a.isTop===0?"置顶":"不置顶";y({title:"提示",message:v("p",null,[`确定要修改文章[${a.title}]为`,v("font",{style:"color: var(--el-color-warning)"},o),"吗?"]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let g={id:a.id,isTop:a.isTop===0?1:0};Ne(g).then(r=>{r.code===200?(m(),f.success("修改成功")):f.error("修改失败")})}).catch(()=>{})}function B(a){let o=a.status===0?"草稿":"发布";y({title:"提示",message:v("p",null,[`确定要将文章[${a.title}]修改为`,v("font",{style:"color: var(--el-color-warning)"},o),"吗?"]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let g={id:a.id,status:a.status===0?1:0};Ae(g).then(r=>{r.code===200?(m(),f.success("修改成功")):f.error("修改失败")})}).catch(()=>{})}return m(),P(),L(),(a,o)=>{const g=pe,r=me,k=we,I=_e,G=Ie,_=fe,H=ge,J=Ee,K=Be,s=ye,U=he,Q=Ve,z=ve,W=be,X=Ce,Y=ke;return c(),S("div",De,[w("div",Pe,[t(H,{inline:!0,model:l(i),class:"demo-form-inline",ref_key:"searchFormRef",ref:x},{default:n(()=>[t(r,{label:"文章标题"},{default:n(()=>[t(g,{modelValue:l(i).title,"onUpdate:modelValue":o[0]||(o[0]=e=>l(i).title=e),placeholder:"请输入文章标题",clearable:""},null,8,["modelValue"])]),_:1}),t(r,{label:"文章状态"},{default:n(()=>[t(I,{modelValue:l(i).status,"onUpdate:modelValue":o[1]||(o[1]=e=>l(i).status=e),placeholder:"请选择文章状态",style:{width:"200px"},clearable:""},{default:n(()=>[(c(),u(k,{key:0,label:"已发布",value:0})),(c(),u(k,{key:1,label:"草稿箱",value:1}))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"所属分类"},{default:n(()=>[t(G,{modelValue:l(i).categoryId,"onUpdate:modelValue":o[2]||(o[2]=e=>l(i).categoryId=e),data:l(V),props:l(D),"check-strictly":"","render-after-expand":!1,style:{width:"200px"},clearable:"",placeholder:"请选择所属分类"},null,8,["modelValue","data","props"])]),_:1}),t(r,{label:"所属标签"},{default:n(()=>[t(I,{modelValue:l(i).tagId,"onUpdate:modelValue":o[3]||(o[3]=e=>l(i).tagId=e),placeholder:"请选择或新增标签",style:{width:"200px"},clearable:""},{default:n(()=>[(c(!0),S(te,null,le(l(E),e=>(c(),u(k,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(r,null,{default:n(()=>[t(_,{type:"primary",onClick:m,icon:l(ae)},{default:n(()=>[p("查询")]),_:1},8,["icon"]),t(_,{icon:l(A),onClick:M},{default:n(()=>[p("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),t(K,{gutter:10,class:"mb8"},{default:n(()=>[t(J,{span:1.5},{default:n(()=>[t(_,{icon:l(ne),type:"primary",plain:"",onClick:R},{default:n(()=>[p("写文章")]),_:1},8,["icon"])]),_:1}),w("div",Le,[t(_,{icon:l(A),circle:"",onClick:m},null,8,["icon"])])]),_:1}),w("div",Me,[oe((c(),u(W,{data:l(T),style:{width:"100%",height:"100%"},"row-key":"id"},{default:n(()=>[t(s,{label:"序号","min-width":"50",type:"index",fixed:""}),t(s,{prop:"title",label:"文章标题","min-width":"150",fixed:""}),t(s,{prop:"status",label:"状态","min-width":"80"},{default:n(e=>[e.row.status===0?(c(),u(U,{key:0,type:"success"},{default:n(()=>[p("已发布")]),_:1})):(c(),u(U,{key:1,type:"danger"},{default:n(()=>[p("草稿箱")]),_:1}))]),_:1}),t(s,{prop:"slug",label:"访问地址别名","min-width":"100"}),t(s,{prop:"thumbnail",label:"封面图","min-width":"80"},{default:n(e=>[e.row.thumbnail?(c(),u(Q,{key:0,style:{width:"100%","max-height":"100%"},src:e.row.thumbnail,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[e.row.thumbnail],"initial-index":4,"append-to-body":"",fit:"cover","preview-teleported":""},null,8,["src","preview-src-list"])):C("",!0)]),_:1}),t(s,{prop:"viewCount",label:"阅读数量","min-width":"70",align:"center"}),t(s,{prop:"greatCount",label:"点赞数量","min-width":"70",align:"center"}),t(s,{prop:"commentCount",label:"评论数量","min-width":"70",align:"center"}),t(s,{prop:"isComment",label:"允许评论","min-width":"80",align:"center"},{default:n(e=>[t(z,{modelValue:e.row.isComment,"onUpdate:modelValue":d=>e.row.isComment=d,"active-value":1,"inactive-value":0,"inline-prompt":"","active-icon":l(F),"inactive-icon":l(N),onClick:$(d=>O(e.row),["prevent"]),disabled:""},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","onClick"])]),_:1}),t(s,{prop:"isTop",label:"是否置顶","min-width":"80",align:"center"},{default:n(e=>[t(z,{modelValue:e.row.isTop,"onUpdate:modelValue":d=>e.row.isTop=d,"active-value":1,"inactive-value":0,"inline-prompt":"","active-icon":l(F),"inactive-icon":l(N),onClick:$(d=>q(e.row),["prevent"]),disabled:""},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","onClick"])]),_:1}),t(s,{prop:"userName",label:"创建人","min-width":"100"}),t(s,{prop:"createTime",label:"创建时间","min-width":"120"},{default:n(e=>[w("span",null,ie(l(xe)(e.row.createTime)),1)]),_:1}),t(s,{label:"操作",width:"190",fixed:"right"},{default:n(e=>[e.row.status===1?(c(),u(_,{key:0,size:"small",type:"primary",link:"",icon:l(se),onClick:d=>B(e.row)},{default:n(()=>[p("发布")]),_:2},1032,["icon","onClick"])):C("",!0),e.row.status===0?(c(),u(_,{key:1,size:"small",type:"primary",link:"",icon:l(re),onClick:d=>B(e.row)},{default:n(()=>[p("草稿")]),_:2},1032,["icon","onClick"])):C("",!0),t(_,{size:"small",type:"primary",link:"",icon:l(ce),onClick:d=>(e.row,void 0)},{default:n(()=>[p("修改")]),_:2},1032,["icon","onClick"]),t(_,{size:"small",type:"primary",link:"",icon:l(de),onClick:d=>j(e.row)},{default:n(()=>[p("删除")]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[Y,l(b)]]),t(X,{"current-page":l(i).pageNo,"onUpdate:currentPage":o[4]||(o[4]=e=>l(i).pageNo=e),"page-size":l(i).pageSize,"onUpdate:pageSize":o[5]||(o[5]=e=>l(i).pageSize=e),"page-sizes":[10,20,30,50],layout:"total,sizes,prev, pager, next, jumper",background:"",small:"",onChange:m,total:l(i).total},null,8,["current-page","page-size","total"])])])}}},ot=Z(Re,[["__scopeId","data-v-b91c0316"]]);export{ot as default};
