import{r as m,l as H,a as u,y as I,b as k,d as K,e as b,f as e,w as a,u as l,z as O,h as c,B as F,C as Q,D as W,k as N,t as X,J as Y,M as Z,N as ee,j as A,E as g,p as te}from"./index-R5kZ6j8p.js";function le(d){return axios.post("/api/auth/site/page",d)}function ae(d){return axios.post("/api/auth/site/add",d)}function oe(d){return axios.get("/api/auth/site/get?id="+d)}function ie(d){return axios.post("/api/auth/site/update",d)}function se(d){return axios.delete("/api/auth/site/del?id="+d)}const ne={class:"page"},ue={class:"search-box"},de={class:"right-tool"},re={class:"table-box"},ce={class:"dialog-footer"},me={__name:"SiteView",setup(d){let x=m(!1),C=m([]),s=m(!1),V=m("");const S=m(),y=m(),n=m({pageNo:1,pageSize:20,total:0,name:""}),i=m({id:"",siteName:"",siteSlug:"",siteDesc:""}),U=H({siteName:[{required:!0,message:"请输入站点名称",trigger:"blur"}],siteSlug:[{required:!0,message:"请输入站点访问标识",trigger:"blur"}]});function B(){n.value={name:""},S.value.resetFields()}function f(){x.value=!0,le(n.value).then(r=>{C.value=r.data.list,n.value.total=r.data.total,x.value=!1})}function R(){v(),V.value="添加站点",s.value=!0}function v(){i.value={id:"",siteName:"",siteSlug:"",siteDesc:""},y.value&&y.value.resetFields()}function T(){y.value.validate(r=>{r&&(i.value.id?ie(i.value).then(t=>{t.code===200?(g.success("操作成功"),s.value=!1,v(),f()):g.error(t.msg)}):ae(i.value).then(t=>{t.code===200?(g.success("操作成功"),s.value=!1,v(),f()):g.error(t.msg)}))})}function E(r){v(),V.value="修改站点",s.value=!0,oe(r.id).then(t=>{i.value=t.data})}function M(r){te.confirm("确定要删除["+r.siteName+"]吗？删除后将造成该站点下所有数据不可访问!","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{se(r.id).then(t=>{t.code===200&&t.data?(g.success("删除成功"),f()):g.error(t.msg)})}).catch(()=>{})}return f(),(r,t)=>{const w=u("el-input"),h=u("el-form-item"),p=u("el-button"),D=u("el-form"),j=u("el-col"),q=u("el-row"),_=u("el-table-column"),z=u("el-tag"),P=u("el-table"),$=u("el-pagination"),G=u("el-dialog"),J=I("loading");return k(),K("div",ne,[b("div",ue,[e(D,{inline:!0,model:l(n),class:"demo-form-inline",ref_key:"searchFormRef",ref:S},{default:a(()=>[e(h,{label:"站点名称"},{default:a(()=>[e(w,{modelValue:l(n).name,"onUpdate:modelValue":t[0]||(t[0]=o=>l(n).name=o),placeholder:"请输入站点名称",clearable:""},null,8,["modelValue"])]),_:1}),e(h,null,{default:a(()=>[e(p,{type:"primary",onClick:f,icon:l(O)},{default:a(()=>[c("查询")]),_:1},8,["icon"]),e(p,{icon:l(F),onClick:B},{default:a(()=>[c("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),e(q,{gutter:10,class:"mb8"},{default:a(()=>[e(j,{span:1.5},{default:a(()=>[e(p,{icon:l(Q),type:"primary",plain:"",onClick:R},{default:a(()=>[c("新增")]),_:1},8,["icon"])]),_:1}),b("div",de,[e(p,{icon:l(F),circle:"",onClick:f},null,8,["icon"])])]),_:1}),b("div",re,[W((k(),N(P,{data:l(C),style:{width:"100%",height:"100%"},"row-key":"id"},{default:a(()=>[e(_,{label:"序号","min-width":"80",type:"index"}),e(_,{prop:"siteName",label:"站点名称","min-width":"150"}),e(_,{prop:"siteSlug",label:"访问标识","min-width":"240"}),e(_,{prop:"siteDesc",label:"站点描述","min-width":"150"}),e(_,{prop:"status",label:"状态",width:"80"},{default:a(o=>[o.row.status===0?(k(),N(z,{key:0,class:"ml-2",type:"success"},{default:a(()=>[c("开启")]),_:1})):(k(),N(z,{key:1,class:"ml-2",type:"danger"},{default:a(()=>[c("关闭")]),_:1}))]),_:1}),e(_,{prop:"createTime",label:"创建时间","min-width":"120"},{default:a(o=>[b("span",null,X(l(Y)(o.row.createTime)),1)]),_:1}),e(_,{label:"操作",width:"180",fixed:"right"},{default:a(o=>[e(p,{size:"small",type:"primary",link:"",icon:l(Z),onClick:L=>E(o.row)},{default:a(()=>[c("修改")]),_:2},1032,["icon","onClick"]),e(p,{size:"small",type:"primary",link:"",icon:l(ee),onClick:L=>M(o.row)},{default:a(()=>[c("删除")]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[J,l(x)]]),e($,{"current-page":l(n).pageNo,"onUpdate:currentPage":t[1]||(t[1]=o=>l(n).pageNo=o),"page-size":l(n).pageSize,"onUpdate:pageSize":t[2]||(t[2]=o=>l(n).pageSize=o),"page-sizes":[10,20,30,50],layout:"total,sizes,prev, pager, next, jumper",background:"",small:"",onChange:f,total:l(n).total},null,8,["current-page","page-size","total"])]),e(G,{modelValue:l(s),"onUpdate:modelValue":t[7]||(t[7]=o=>A(s)?s.value=o:s=o),title:l(V),width:"600px",draggable:""},{footer:a(()=>[b("span",ce,[e(p,{type:"primary",onClick:T},{default:a(()=>[c("确 定")]),_:1}),e(p,{onClick:t[6]||(t[6]=o=>{A(s)?s.value=!1:s=!1,v()})},{default:a(()=>[c("取 消")]),_:1})])]),default:a(()=>[e(D,{ref_key:"addFormRef",ref:y,model:l(i),"label-width":"80px","status-icon":"",rules:l(U)},{default:a(()=>[e(h,{label:"站点名称",prop:"siteName"},{default:a(()=>[e(w,{modelValue:l(i).siteName,"onUpdate:modelValue":t[3]||(t[3]=o=>l(i).siteName=o),placeholder:"请输入站点名称"},null,8,["modelValue"])]),_:1}),e(h,{label:"站点标识",prop:"siteSlug"},{default:a(()=>[e(w,{modelValue:l(i).siteSlug,"onUpdate:modelValue":t[4]||(t[4]=o=>l(i).siteSlug=o),placeholder:"请输入站点访问标识"},null,8,["modelValue"])]),_:1}),e(h,{label:"站点描述",prop:"siteDesc"},{default:a(()=>[e(w,{modelValue:l(i).siteDesc,"onUpdate:modelValue":t[5]||(t[5]=o=>l(i).siteDesc=o),placeholder:"请输入站点描述",autosize:{minRows:3,maxRows:6},type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}};export{me as default};
