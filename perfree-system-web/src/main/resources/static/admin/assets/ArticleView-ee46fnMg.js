import{_ as ee,r as v,l as te,a as s,y as le,b as d,d as N,e as y,f as t,w as n,u as l,k as p,F as ae,m as ne,z as oe,h as m,B as S,C as ie,D as se,i as x,G as $,H as F,I as E,t as re,J as ce,K as de,L as ue,M as pe,N as me,n as _e,q as fe,p as b,E as g,O as w}from"./index-DQCGZ03O.js";import{g as ge}from"./tag-BQCuFRh1.js";import{b as he,c as ve,d as we,e as ye,f as be}from"./article-DLLIOUN2.js";import{c as ke}from"./category-BFkxnEz5.js";const Ce={class:"page"},xe={class:"search-box"},Ve={class:"right-tool"},Te={class:"table-box"},Be={__name:"ArticleView",setup(Ue){const i=v({pageNo:1,pageSize:20,total:0,title:"",type:"article",status:null,categoryId:null,tagId:null}),V=v();let T=v([]),k=v(!1);const L=te({children:"children",label:"name",value:"id"});let B=v([]),U=v([]);function _(){k.value=!0,he(i.value).then(a=>{T.value=a.data.list,i.value.total=a.data.total,k.value=!1})}function M(){ke({}).then(a=>{B.value=_e(a.data,"id","pid","children",-1)})}function P(){ge().then(a=>{U.value=a.data})}function R(){i.value={title:"",type:"article",status:null,categoryId:null,tagId:null},V.value.resetFields()}function j(){fe("","/admin/article/create","")}function ze(a){}function q(a){b.confirm("确定要删除文章["+a.title+"]吗？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{ve(a.id).then(o=>{o.code===200&&o.data?(g.success("删除成功"),_()):g.error(o.msg)})}).catch(()=>{})}function G(a){let o=a.isComment===0?"允许评论":"不允许评论";b({title:"提示",message:w("p",null,[`确定要修改文章[${a.title}]为`,w("font",{style:"color: var(--el-color-warning)"},o),"吗?"]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let h={id:a.id,isComment:a.isComment===0?1:0};ye(h).then(c=>{c.code===200?(_(),g.success("修改成功")):g.error("修改失败")})}).catch(()=>{})}function H(a){let o=a.isTop===0?"置顶":"不置顶";b({title:"提示",message:w("p",null,[`确定要修改文章[${a.title}]为`,w("font",{style:"color: var(--el-color-warning)"},o),"吗?"]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let h={id:a.id,isTop:a.isTop===0?1:0};be(h).then(c=>{c.code===200?(_(),g.success("修改成功")):g.error("修改失败")})}).catch(()=>{})}function z(a){let o=a.status===0?"草稿":"发布";b({title:"提示",message:w("p",null,[`确定要将文章[${a.title}]修改为`,w("font",{style:"color: var(--el-color-warning)"},o),"吗?"]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let h={id:a.id,status:a.status===0?1:0};we(h).then(c=>{c.code===200?(_(),g.success("修改成功")):g.error("修改失败")})}).catch(()=>{})}return _(),M(),P(),(a,o)=>{const h=s("el-input"),c=s("el-form-item"),C=s("el-option"),I=s("el-select"),J=s("el-tree-select"),f=s("el-button"),K=s("el-form"),O=s("el-col"),Q=s("el-row"),r=s("el-table-column"),A=s("el-tag"),W=s("el-image"),D=s("el-switch"),X=s("el-table"),Y=s("el-pagination"),Z=le("loading");return d(),N("div",Ce,[y("div",xe,[t(K,{inline:!0,model:l(i),class:"demo-form-inline",ref_key:"searchFormRef",ref:V},{default:n(()=>[t(c,{label:"文章标题"},{default:n(()=>[t(h,{modelValue:l(i).title,"onUpdate:modelValue":o[0]||(o[0]=e=>l(i).title=e),placeholder:"请输入文章标题",clearable:""},null,8,["modelValue"])]),_:1}),t(c,{label:"文章状态"},{default:n(()=>[t(I,{modelValue:l(i).status,"onUpdate:modelValue":o[1]||(o[1]=e=>l(i).status=e),placeholder:"请选择文章状态",style:{width:"200px"},clearable:""},{default:n(()=>[(d(),p(C,{key:0,label:"已发布",value:0})),(d(),p(C,{key:1,label:"草稿箱",value:1}))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"所属分类"},{default:n(()=>[t(J,{modelValue:l(i).categoryId,"onUpdate:modelValue":o[2]||(o[2]=e=>l(i).categoryId=e),data:l(B),props:l(L),"check-strictly":"","render-after-expand":!1,style:{width:"200px"},clearable:"",placeholder:"请选择所属分类"},null,8,["modelValue","data","props"])]),_:1}),t(c,{label:"所属标签"},{default:n(()=>[t(I,{modelValue:l(i).tagId,"onUpdate:modelValue":o[3]||(o[3]=e=>l(i).tagId=e),placeholder:"请选择或新增标签",style:{width:"200px"},clearable:""},{default:n(()=>[(d(!0),N(ae,null,ne(l(U),e=>(d(),p(C,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,null,{default:n(()=>[t(f,{type:"primary",onClick:_,icon:l(oe)},{default:n(()=>[m("查询")]),_:1},8,["icon"]),t(f,{icon:l(S),onClick:R},{default:n(()=>[m("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),t(Q,{gutter:10,class:"mb8"},{default:n(()=>[t(O,{span:1.5},{default:n(()=>[t(f,{icon:l(ie),type:"primary",plain:"",onClick:j},{default:n(()=>[m("写文章")]),_:1},8,["icon"])]),_:1}),y("div",Ve,[t(f,{icon:l(S),circle:"",onClick:_},null,8,["icon"])])]),_:1}),y("div",Te,[se((d(),p(X,{data:l(T),style:{width:"100%",height:"100%"},"row-key":"id"},{default:n(()=>[t(r,{label:"序号","min-width":"50",type:"index",fixed:""}),t(r,{prop:"title",label:"文章标题","min-width":"150",fixed:""}),t(r,{prop:"status",label:"状态","min-width":"80"},{default:n(e=>[e.row.status===0?(d(),p(A,{key:0,type:"success"},{default:n(()=>[m("已发布")]),_:1})):(d(),p(A,{key:1,type:"danger"},{default:n(()=>[m("草稿箱")]),_:1}))]),_:1}),t(r,{prop:"slug",label:"访问地址别名","min-width":"100"}),t(r,{prop:"thumbnail",label:"封面图","min-width":"80"},{default:n(e=>[e.row.thumbnail?(d(),p(W,{key:0,style:{width:"100%","max-height":"100%"},src:e.row.thumbnail,"zoom-rate":1.2,"max-scale":7,"min-scale":.2,"preview-src-list":[e.row.thumbnail],"initial-index":4,"append-to-body":"",fit:"cover","preview-teleported":""},null,8,["src","preview-src-list"])):x("",!0)]),_:1}),t(r,{prop:"viewCount",label:"阅读数量","min-width":"70",align:"center"}),t(r,{prop:"greatCount",label:"点赞数量","min-width":"70",align:"center"}),t(r,{prop:"commentCount",label:"评论数量","min-width":"70",align:"center"}),t(r,{prop:"isComment",label:"允许评论","min-width":"80",align:"center"},{default:n(e=>[t(D,{modelValue:e.row.isComment,"onUpdate:modelValue":u=>e.row.isComment=u,"active-value":1,"inactive-value":0,"inline-prompt":"","active-icon":l($),"inactive-icon":l(F),onClick:E(u=>G(e.row),["prevent"]),disabled:""},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","onClick"])]),_:1}),t(r,{prop:"isTop",label:"是否置顶","min-width":"80",align:"center"},{default:n(e=>[t(D,{modelValue:e.row.isTop,"onUpdate:modelValue":u=>e.row.isTop=u,"active-value":1,"inactive-value":0,"inline-prompt":"","active-icon":l($),"inactive-icon":l(F),onClick:E(u=>H(e.row),["prevent"]),disabled:""},null,8,["modelValue","onUpdate:modelValue","active-icon","inactive-icon","onClick"])]),_:1}),t(r,{prop:"userName",label:"创建人","min-width":"100"}),t(r,{prop:"createTime",label:"创建时间","min-width":"120"},{default:n(e=>[y("span",null,re(l(ce)(e.row.createTime)),1)]),_:1}),t(r,{label:"操作",width:"190",fixed:"right"},{default:n(e=>[e.row.status===1?(d(),p(f,{key:0,size:"small",type:"primary",link:"",icon:l(de),onClick:u=>z(e.row)},{default:n(()=>[m("发布")]),_:2},1032,["icon","onClick"])):x("",!0),e.row.status===0?(d(),p(f,{key:1,size:"small",type:"primary",link:"",icon:l(ue),onClick:u=>z(e.row)},{default:n(()=>[m("草稿")]),_:2},1032,["icon","onClick"])):x("",!0),t(f,{size:"small",type:"primary",link:"",icon:l(pe),onClick:u=>(e.row,void 0)},{default:n(()=>[m("修改")]),_:2},1032,["icon","onClick"]),t(f,{size:"small",type:"primary",link:"",icon:l(me),onClick:u=>q(e.row)},{default:n(()=>[m("删除")]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[Z,l(k)]]),t(Y,{"current-page":l(i).pageNo,"onUpdate:currentPage":o[4]||(o[4]=e=>l(i).pageNo=e),"page-size":l(i).pageSize,"onUpdate:pageSize":o[5]||(o[5]=e=>l(i).pageSize=e),"page-sizes":[10,20,30,50],layout:"total,sizes,prev, pager, next, jumper",background:"",small:"",onChange:_,total:l(i).total},null,8,["current-page","page-size","total"])])])}}},Se=ee(Be,[["__scopeId","data-v-b91c0316"]]);export{Se as default};
