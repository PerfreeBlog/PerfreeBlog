import{r as m,k as $,a as w,b as H,d as h,e,w as l,u as a,C as O,f as d,D,G as Q,H as J,j as E,t as K,N as W,O as X,i as F,m as _,q as Y,s as Z,E as ee,y as te,Q as ae}from"./index-DAZg6KgI.js";import{E as le,a as oe,v as ie}from"./el-table-column-DZMpWYo5.js";import"./el-dialog-Cx6vfFNe.js";import{E as se}from"./el-pagination-x5Aplci8.js";import{p as ne}from"./perfree-h22k_lv_.js";import{E as re,a as ue}from"./el-col-Y4mM9eD_.js";import{E as de}from"./index-DNxUcOTo.js";import{E as pe}from"./index-AgTUDQsJ.js";function me(r){return axios.post("/api/auth/site/page",r)}function ce(r){return axios.post("/api/auth/site/add",r)}function fe(r){return axios.get("/api/auth/site/get?id="+r)}function _e(r){return axios.post("/api/auth/site/update",r)}function ge(r){return axios.delete("/api/auth/site/del?id="+r)}const ve={class:"page"},he={class:"search-box"},be={class:"right-tool"},ye={class:"table-box"},we={class:"dialog-footer"},Fe={__name:"SiteView",setup(r){let k=m(!1),V=m([]),s=m(!1),x=m("");const C=m(),b=m(),n=m({pageNo:1,pageSize:20,total:0,name:""}),i=m({id:"",siteName:"",siteSlug:"",siteDesc:""}),z=$({siteName:[{required:!0,message:"请输入站点名称",trigger:"blur"}],siteSlug:[{required:!0,message:"请输入站点访问标识",trigger:"blur"}]});function A(){n.value={name:""},C.value.resetFields()}function c(){k.value=!0,me(n.value).then(u=>{V.value=u.data.list,n.value.total=u.data.total,k.value=!1})}function R(){g(),x.value="添加站点",s.value=!0}function g(){i.value={id:"",siteName:"",siteSlug:"",siteDesc:""},b.value&&b.value.resetFields()}function T(){b.value.validate(u=>{u&&(i.value.id?_e(i.value).then(t=>{t.code===200?(_.success("操作成功"),s.value=!1,g(),c()):_.error(t.msg)}):ce(i.value).then(t=>{t.code===200?(_.success("操作成功"),s.value=!1,g(),c()):_.error(t.msg)}))})}function U(u){g(),x.value="修改站点",s.value=!0,fe(u.id).then(t=>{i.value=t.data})}function B(u){de.confirm("确定要删除["+u.siteName+"]吗？删除后将造成该站点下所有数据不可访问!","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{ge(u.id).then(t=>{t.code===200&&t.data?(_.success("删除成功"),c()):_.error(t.msg)})}).catch(()=>{})}return c(),(u,t)=>{const y=Y,v=Z,p=ee,N=te,q=re,P=ue,f=le,S=ae,j=oe,G=se,I=pe,L=ie;return w(),H("div",ve,[h("div",he,[e(N,{inline:!0,model:a(n),class:"demo-form-inline",ref_key:"searchFormRef",ref:C},{default:l(()=>[e(v,{label:"站点名称"},{default:l(()=>[e(y,{modelValue:a(n).name,"onUpdate:modelValue":t[0]||(t[0]=o=>a(n).name=o),placeholder:"请输入站点名称",clearable:""},null,8,["modelValue"])]),_:1}),e(v,null,{default:l(()=>[e(p,{type:"primary",onClick:c,icon:a(O)},{default:l(()=>[d("查询")]),_:1},8,["icon"]),e(p,{icon:a(D),onClick:A},{default:l(()=>[d("重置")]),_:1},8,["icon"])]),_:1})]),_:1},8,["model"])]),e(P,{gutter:10,class:"mb8"},{default:l(()=>[e(q,{span:1.5},{default:l(()=>[e(p,{icon:a(Q),type:"primary",plain:"",onClick:R},{default:l(()=>[d("新增")]),_:1},8,["icon"])]),_:1}),h("div",be,[e(p,{icon:a(D),circle:"",onClick:c},null,8,["icon"])])]),_:1}),h("div",ye,[J((w(),E(j,{data:a(V),style:{width:"100%",height:"100%"},"row-key":"id"},{default:l(()=>[e(f,{label:"序号","min-width":"80",type:"index"}),e(f,{prop:"siteName",label:"站点名称","min-width":"150"}),e(f,{prop:"siteSlug",label:"访问标识","min-width":"240"}),e(f,{prop:"siteDesc",label:"站点描述","min-width":"150"}),e(f,{prop:"status",label:"状态",width:"80"},{default:l(o=>[o.row.status===0?(w(),E(S,{key:0,class:"ml-2",type:"success"},{default:l(()=>[d("开启")]),_:1})):(w(),E(S,{key:1,class:"ml-2",type:"danger"},{default:l(()=>[d("关闭")]),_:1}))]),_:1}),e(f,{prop:"createTime",label:"创建时间","min-width":"120"},{default:l(o=>[h("span",null,K(a(ne)(o.row.createTime)),1)]),_:1}),e(f,{label:"操作",width:"180",fixed:"right"},{default:l(o=>[e(p,{size:"small",type:"primary",link:"",icon:a(W),onClick:M=>U(o.row)},{default:l(()=>[d("修改")]),_:2},1032,["icon","onClick"]),e(p,{size:"small",type:"primary",link:"",icon:a(X),onClick:M=>B(o.row)},{default:l(()=>[d("删除")]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[L,a(k)]]),e(G,{"current-page":a(n).pageNo,"onUpdate:currentPage":t[1]||(t[1]=o=>a(n).pageNo=o),"page-size":a(n).pageSize,"onUpdate:pageSize":t[2]||(t[2]=o=>a(n).pageSize=o),"page-sizes":[10,20,30,50],layout:"total,sizes,prev, pager, next, jumper",background:"",small:"",onChange:c,total:a(n).total},null,8,["current-page","page-size","total"])]),e(I,{modelValue:a(s),"onUpdate:modelValue":t[7]||(t[7]=o=>F(s)?s.value=o:s=o),title:a(x),width:"600px",draggable:""},{footer:l(()=>[h("span",we,[e(p,{type:"primary",onClick:T},{default:l(()=>[d("确 定")]),_:1}),e(p,{onClick:t[6]||(t[6]=o=>{F(s)?s.value=!1:s=!1,g()})},{default:l(()=>[d("取 消")]),_:1})])]),default:l(()=>[e(N,{ref_key:"addFormRef",ref:b,model:a(i),"label-width":"80px","status-icon":"",rules:a(z)},{default:l(()=>[e(v,{label:"站点名称",prop:"siteName"},{default:l(()=>[e(y,{modelValue:a(i).siteName,"onUpdate:modelValue":t[3]||(t[3]=o=>a(i).siteName=o),placeholder:"请输入站点名称"},null,8,["modelValue"])]),_:1}),e(v,{label:"站点标识",prop:"siteSlug"},{default:l(()=>[e(y,{modelValue:a(i).siteSlug,"onUpdate:modelValue":t[4]||(t[4]=o=>a(i).siteSlug=o),placeholder:"请输入站点访问标识"},null,8,["modelValue"])]),_:1}),e(v,{label:"站点描述",prop:"siteDesc"},{default:l(()=>[e(y,{modelValue:a(i).siteDesc,"onUpdate:modelValue":t[5]||(t[5]=o=>a(i).siteDesc=o),placeholder:"请输入站点描述",autosize:{minRows:3,maxRows:6},type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}};export{Fe as default};
