import{_ as M,c as A,l as P,d as K,C as z,g as D,e as c,i as U}from"../../index-Cbj4A6nx.js";const n=window.Vue.createElementVNode,m=window.Vue.unref,p=window.Vue.openBlock,y=window.Vue.createElementBlock,x=window.Vue.createCommentVNode,a=window.Vue.resolveComponent,t=window.Vue.createVNode,s=window.Vue.withCtx,b=window.Vue.withKeys,W=window.Vue.createBlock,q=window.Vue.withModifiers,C=window.Vue.createTextVNode,G={class:"container"},L={class:"login-box"},H={key:0,style:{"font-size":"13px",color:"var(--el-text-color-regular)","margin-bottom":"10px"}},F={class:"login-code"},J=["src"],$={class:"login-bottom-box"},j={key:0,class:"register-box"},Q={class:"forget-password-box"},X=window.ElementPlus.ElMessage,Y=window.VueRouter.useRouter,Z=window.Vue.computed,ee=window.Vue.getCurrentInstance,i=window.Vue.ref,oe={__name:"LoginView",setup(te){const{proxy:R}=ee(),h=Y();let _=i(!1),f=i(!1),E=i(!1);const B=A(),o=i({username:"",password:"",rememberMe:!1,code:"",uuid:""}),O=Z(()=>({username:[{required:!0,trigger:"blur",message:"请输入您的账户"}],password:[{required:!0,trigger:"blur",message:"请输入您的密码"}],code:[{required:!0,trigger:"blur",message:"请输入验证码"}]}));let k=i("");const g=i(!1),w=()=>{R.$refs.loginRef.validate(l=>{l&&P(o.value).then(e=>{e.code===200?(B.setMenuInit(!1),K(),localStorage.setItem(z.STORAGE_TOKEN,JSON.stringify(e.data)),h.replace("/admin")):(X.error(e.msg),o.value.code="",g.value=!1,d())}).catch(()=>{o.value.code="",g.value=!1,d()})})},d=()=>{D().then(l=>{k.value="data:image/gif;base64,"+l.data.img,o.value.uuid=l.data.uuid})},S=()=>{f.value=c("WEB_OPEN_CAPTCHA","system_setting")?c("WEB_OPEN_CAPTCHA","system_setting").value==="ON":!0,E.value=c("WEB_IS_REGISTER","system_setting")?c("WEB_IS_REGISTER","system_setting").value==="ON":!0,f.value&&d()};return(()=>{U().then(l=>{l.code===200&&(_.value=l.data),_.value&&(o.value.username="admin",o.value.password="123456")})})(),S(),(l,e)=>{const v=a("font-awesome-icon"),V=a("el-input"),u=a("el-form-item"),T=a("el-button"),N=a("router-link"),I=a("el-form");return p(),y("div",G,[n("div",L,[t(I,{ref:"loginRef",model:o.value,rules:O.value,class:"login-form"},{default:s(()=>[e[7]||(e[7]=n("h3",{class:"title"},"Perfree",-1)),m(_)?(p(),y("div",H,"演示环境默认账户admin,密码123456")):x("",!0),t(u,{prop:"username"},{default:s(()=>[t(V,{modelValue:o.value.username,"onUpdate:modelValue":e[0]||(e[0]=r=>o.value.username=r),type:"text",size:"large","auto-complete":"off",placeholder:"请输入账户"},{prefix:s(()=>[t(v,{icon:"fa-regular fa-user "})]),_:1},8,["modelValue"])]),_:1}),t(u,{prop:"password"},{default:s(()=>[t(V,{modelValue:o.value.password,"onUpdate:modelValue":e[1]||(e[1]=r=>o.value.password=r),type:"password",size:"large","auto-complete":"off",placeholder:"请输入密码",onKeyup:b(w,["enter"])},{prefix:s(()=>[t(v,{icon:"fa-solid fa-lock "})]),_:1},8,["modelValue"])]),_:1}),m(f)?(p(),W(u,{key:1,prop:"code"},{default:s(()=>[t(V,{modelValue:o.value.code,"onUpdate:modelValue":e[2]||(e[2]=r=>o.value.code=r),"auto-complete":"off",placeholder:"请输入验证码",size:"large",style:{width:"63%"},onKeyup:b(w,["enter"])},{prefix:s(()=>[t(v,{icon:"fa-solid fa-fax  "})]),_:1},8,["modelValue"]),n("div",F,[n("img",{src:m(k),onClick:d,class:"login-code-img"},null,8,J)])]),_:1})):x("",!0),t(u,{style:{width:"100%","margin-top":"20px"}},{default:s(()=>[t(T,{loading:g.value,size:"large",type:"primary",style:{width:"100%"},onClick:q(w,["prevent"])},{default:s(()=>e[3]||(e[3]=[n("span",null,"登 录",-1)])),_:1},8,["loading"]),n("div",$,[m(E)?(p(),y("div",j,[e[5]||(e[5]=C(" 没有账号? ")),t(N,{class:"link-type",to:"/register"},{default:s(()=>e[4]||(e[4]=[C("立即注册")])),_:1})])):x("",!0),n("div",Q,[t(N,{class:"link-type",to:"/findPassword"},{default:s(()=>e[6]||(e[6]=[C("忘记密码?")])),_:1})])])]),_:1})]),_:1},8,["model","rules"])]),e[8]||(e[8]=n("div",{class:"login-footer"},[n("span",null,"Copyright © 2018-2024 All Rights Reserved. ")],-1))])}}},le=M(oe,[["__scopeId","data-v-c5a96e84"]]);export{le as default};
